This is based on Escard√≥'s "effectful forcing" development. See http://www.cs.bham.ac.uk/~mhe/dialogue/dialogue-lambda.html for the original code and work to which we owe so much!
